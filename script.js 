import config from './config.js';

document.addEventListener('DOMContentLoaded', () => {
    const terms = document.querySelectorAll('.wiki-term'); // Select all terms
    const sidebar = document.getElementById('sidebar'); // Get the sidebar element

    // Function to open the sidebar and load content from Airtable
    const openSidebar = (entryName) => {
        axios.get(`${config.airtableBaseURL}?filterByFormula={Name}="${entryName}"`, {
            headers: { Authorization: `Bearer ${config.airtableAPIKey}` }
        })
        .then(response => {
            const records = response.data.records;
            if (records.length > 0) {
                const item = records[0].fields;
                sidebar.innerHTML = `
                    <h3>${item.Name}</h3>
                    <p>${item.Description}</p>
                    ${item.Image ? `<img src="${item.Image[0].url}" alt="${item.Name}" style="max-width:100%;">` : ''}
                `;
                sidebar.classList.add('open');
            } else {
                sidebar.innerHTML = `<p>No entry found for "${entryName}"</p>`;
            }
        })
        .catch(error => {
            console.error('Error fetching data from Airtable:', error);
            sidebar.innerHTML = `<p>Error fetching data. Please try again later.</p>`;
        });
    };

    // Add event listeners to each term
    terms.forEach(term => {
        term.addEventListener('click', () => {
            const entryName = term.textContent.trim();
            openSidebar(entryName);
        });
    });
});
